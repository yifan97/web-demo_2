(function (){"use strict";var FontChange,TitleEditor,Copy,font,title,copy;FontChange=go.Class(go.Ext.Nodes,{'nodes':{'size':{'selector':"#select-size",'events':{'change':"onChange"}},'font':{'selector':"#select-font",'events':{'change':"onChange"}},'char':"#char-node"},'__construct':function (node){this.initNodes(node);this.onChange();},'onChange':function (){var size=parseInt(this.nodes.size.val(),10),lineHeight="";this.nodes.char.css("font-size",size + "px");this.nodes.char.css("font-family",this.nodes.font.val());if (size < 60){lineHeight="50px";}this.nodes.char.css('line-height',lineHeight);},'eoc':null});font=new FontChange("#content");TitleEditor=go.Class(go.Ext.Nodes,{'nodes':{'title':{'selector':"#symbol-title",'events':{'dblclick':"onClickTitle"}},'edit':{'selector':"a.edit",'events':{'click':"onClickEdit"}},'input':{'selector':".title-edit",'events':{'keypress':"onKeypress"}},'save':{'selector':".save",'events':{'click':"onClickSave"}},'undo':{'selector':".undo",'events':{'click':"onClickUndo"}},'number':"#symbol-number"},'__construct':function (node){this.initNodes(node);this.nodes.popup=$("#popup");this.nodes.popupSave=$("#popup .save");this.nodes.popupUndo=$("#popup .undo");this.nodes.popupSend=$("#popup-send");this.nodes.popupThanks=$("#popup-thanks");this.nodes.overlap=$("#overlap");this.nodes.popup.click(this.onClickPopup);this.nodes.popupSave.click(this.onClickPopupSave);this.nodes.popupUndo.click(this.onClickPopupUndo);this.editing=false;this.title=this.nodes.title.text();this.node.click(this.onClickNode);},'toEdit':function (){if (this.editing){return;}this.editing=true;this.nodes.title.hide();this.nodes.input.val(this.title);this.nodes.input.show();this.nodes.input.focus();this.nodes.input.select();this.nodes.save.show();this.nodes.undo.show();this.nodes.edit.hide();this.nodes.popup.hide();this.nodes.overlap.hide();this.nodes.number.hide();if (!this.window){this.window=$(window);this.window.bind("click",this.onClickWindow);}},'fromEdit':function (){if (!this.editing){return;}this.editing=false;this.nodes.title.show();this.nodes.input.hide();this.nodes.save.hide();this.nodes.undo.hide();this.nodes.edit.show();this.nodes.popup.hide();this.nodes.overlap.hide();this.nodes.number.show();},'save':function (){var title=this.nodes.input.val().replace(/^\s+/,"").replace(/\s+$/,""),t=this;if ((title.length > 0) && (title !==this.title)){this.title=title;this.nodes.title.text(title);this.send(title);this.nodes.popupSend.hide();this.nodes.popupThanks.show();this.nodes.popup.fadeOut(1500,function (){t.fromEdit();});}else{this.fromEdit();}},'presave':function (){var title=this.nodes.input.val().replace(/^\s+/,"").replace(/\s+$/,"");if ((title.length > 0) && (title !==this.title)){this.nodes.popup.show();this.nodes.popupSend.show();this.nodes.popupThanks.hide();this.nodes.overlap.show();}else{this.fromEdit();}},'cancel':function (){this.fromEdit();},'send':function (title){jQuery.ajax("/en/a-edit/",{'type':"POST",'data':{'url':window.location.pathname,'text':title}});},'onClickTitle':function (){if (!this.editing){this.toEdit();}},'onClickEdit':function (){if (!this.editing){this.toEdit();}},'onKeypress':function (e){switch (e.keyCode){case 27:this.cancel();break;case 13:this.presave();break;}},'onClickWindow':function (e){if (!e.originalEvent._nowinclick){this.cancel();}},'onClickNode':function (e){e.originalEvent._nowinclick=true;},'onClickSave':function (){this.presave();},'onClickUndo':function (){this.cancel();},'onClickPopup':function (e){e.originalEvent._nowinclick=true;},'onClickPopupSave':function (){this.save();},'onClickPopupUndo':function (){this.cancel();},'eoc':null});})();